<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ—Ä—á –ê—Ä—Å–µ–Ω–∞</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="top-controls">
    <button id="menuToggle" class="menu-toggle">‚ò∞ –ú–µ–Ω—é</button>
    <button id="theme-toggle" class="theme-toggle">üåô / ‚òÄÔ∏è</button>
</div>

<nav id="mainNav" class="nav-sidebar">
    <ul>
        <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
        <li><a href="bio.html">–ë–∏–æ–≥—Ä–∞—Ñ–∏—è</a></li>
        <li><a href="gallery.html">–ì–∞–ª–µ—Ä–µ—è</a></li>
        <li><a href="bag.html">–ë–∞–≥–∞–∂–Ω–∏–∫</a></li>
        <li><a href="form.html">–§–æ—Ä–º–∞</a></li>
        <li><a href="stat.html">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a></li>
        <li><a href="merches.html">–¢–æ–≤–∞—Ä—ã</a></li>
        <li><a href="cart.html">–ö–æ—Ä–∑–∏–Ω–∞</a></li>
    </ul>
    <button class="close-btn">√ó</button>
</nav>

<div id="overlay" class="overlay"></div>

<div class="container">
    <header>
        <h1>–ú–µ—Ä—á –ê—Ä—Å–µ–Ω–∞</h1>
    </header>

    <main>
        <div id="products" class="products"></div>
        <p><a href="cart.html">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É</a></p>
    </main>
</div>

<script>
    async function loadProducts() {
        try {
            const res = await fetch('/products');
            const products = await res.json();
            const container = document.getElementById('products');
            container.innerHTML = '';

            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä
            products.push({id:4, name:"–§—É—Ç–±–æ–ª–∫–∞", price:1590});

            products.forEach(p => {
                const div = document.createElement('div');
                div.className = 'product';
                div.innerHTML = `
                    <h2>${p.name}</h2>
                    <p>–¶–µ–Ω–∞: ${p.price} ‚ÇΩ</p>
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:
                        <input type="number" min="1" value="1" class="qty">
                    </label>
                    <button>–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
                `;

                div.querySelector('button').addEventListener('click', () => {
                    const quantity = parseInt(div.querySelector('.qty').value);
                    fetch('/cart', {
                        method:'POST',
                        headers:{'Content-Type':'application/x-www-form-urlencoded'},
                        body:`id=${p.id}&name=${encodeURIComponent(p.name)}&price=${p.price}&quantity=${quantity}`
                    }).then(() => alert('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ—Ä–∑–∏–Ω—É!'))
                        .catch(() => alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏'));
                });

                container.appendChild(div);
            });
        } catch(err) {
            console.error(err);
            document.getElementById('products').innerHTML = "<p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–≤–∞—Ä—ã</p>";
        }
    }

    loadProducts();
</script>

<script src="script.js"></script>
</body>
</html>
